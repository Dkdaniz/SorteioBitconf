<!DOCTYPE html>
<html>
 
<head>
 <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="https://getbootstrap.com.br/docs/4.1/assets/brand/bootstrap-solid.svg">
    <link href="https://getbootstrap.com.br/docs/4.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://getbootstrap.com.br/docs/4.1/examples/sign-in/signin.css" rel="stylesheet">
  <link type="text/css" rel="stylesheet" charset="UTF-8" href="https://translate.googleapis.com/translate_static/css/translateelement.css">
  <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.2&appId=228967707975824&autoLogAppEvents=1"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <style>
    body { 
      background-image: url('https://descentralizado.com.br/wp-content/uploads/2018/05/logo.png');
      background-attachment: fixed;
      background-position: center top; 
      height: 100%;
      background-size: cover;
    }
</style>

<title>SORTEIO PORTAL DESCENTRALIZADO - BITCONF </title>
<meta charset="UTF-8">
</head>
<body class="text-center">

<script>
  function statusChangeCallback(response) {
    
    if (response.status === 'connected') {
      testAPI();
    } else {
      document.getElementById('status').innerHTML = 'Please log ' + 'into this app.';
    }
  }

  function checkLoginState() {
    FB.getLoginStatus(function(response) {
      statusChangeCallback(response);
      FB.api('/me', function(responses) {
        

          // Post a user
        var url = "http://localhost:3000/api/erc20/eth/recorder";

        var data = {};
        data.name = responses.name;
        data.email  = document.getElementById("inputEmail").value;
        data.id  = responses.id;
        var json = JSON.stringify(data);
        console.log(json);

        var http = new XMLHttpRequest();
        http.open("POST", url, true);
        http.setRequestHeader('Content-type','application/json');
        http.send(json);
        http.onload = function () {
          var res = JSON.parse(http.responseText);
          if (http.readyState == 4 && http.status == "200") {
            console.log(res.hash);
          } else {
            console.error(res.msg);
          }
        }
        });
    });
  }

  window.fbAsyncInit = function() {
    FB.getLoginStatus(function(response) {
      statusChangeCallback(response);
    });
  };


  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "https://connect.facebook.net/en_US/sdk.js";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));

  function testAPI() {
    FB.api('/me', function(response) {
      document.getElementById("inputNome").value = response.name;
    });
  }

  
</script>


<form class="form-signin">
      <font color="red">ATENÇÃO</font><br/>

      <mark><font color="blue">1 - Preencha os campos abaixo e faça login com o facebook</font></mark><br/><br/>
      <mark><font color="blue">2 - Esta aplicação é um sorteio via smart contracts realizado somente a criterio de pesquisa.</font></mark><br/><br/>
      <mark><font color="blue">3 - Preencha os dados corretamente</font></mark><br/><br/>
      <mark><font color="blue"> By: DANIEL MARQUES - www.descentralizado.com.br </font></mark><br/><br/>

      <label for="inputNome" class="sr-only">Nome</label>
      <input type="nome" id="inputNome" class="form-control" placeholder="Nome" required="" autofocus="">
      <label for="inputEmail" class="sr-only">Email</label>
      <input type="email" id="inputEmail" class="form-control" placeholder="Email" required="">
      <div id = "facebook" class="fb-login-button" data-size="large" data-button-type="continue_with" data-auto-logout-link="false" data-use-continue-as="true" onlogin="checkLoginState();"></div>
      <div class="checkbox mb-3">
      </div>
    </form>
<div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div>
</div>

</body>
</html>